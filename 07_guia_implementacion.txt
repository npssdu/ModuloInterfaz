================================================================================
GU√çA DE IMPLEMENTACI√ìN - PROYECTO BD GABINETE DE ABOGADOS
PER√çODO 2025-3 | Profesor: Sonia Ordo√±ez Salinas
================================================================================

üìã TABLA DE CONTENIDOS
1. Descripci√≥n del Proyecto
2. Requisitos del Sistema
3. Estructura de Archivos
4. Instrucciones de Instalaci√≥n
5. Ejecuci√≥n del Proyecto
6. Descripci√≥n de Componentes
7. Consultas Importantes
8. Notas T√©cnicas

================================================================================
1. DESCRIPCI√ìN DEL PROYECTO
================================================================================

Este proyecto implementa un sistema de gesti√≥n para un gabinete de abogados que
incluye:

‚úì Base de datos relacional en Oracle con 17 tablas
‚úì Inserciones de datos de prueba (5 clientes, 5 abogados, casos hipot√©ticos)
‚úì Interfaz web Django para registro y b√∫squeda de clientes
‚úì Conexi√≥n directa a Oracle (sin ORM - SQL puro)
‚úì Validaci√≥n de datos y manejo de errores

================================================================================
2. REQUISITOS DEL SISTEMA
================================================================================

Software necesario:
- Oracle Database 11g o superior
- Python 3.8+
- Django 3.2 o 4.0+
- cx_Oracle (driver de Oracle para Python)
- Power Designer (para dise√±o de BD)

Instalaci√≥n de dependencias Python:
$ pip install django==4.2
$ pip install cx-Oracle==8.3.0

================================================================================
3. ESTRUCTURA DE ARCHIVOS
================================================================================

ProyectoGabinete/
‚îú‚îÄ‚îÄ 01_crear_tablas.sql          # Script de creaci√≥n de tablas
‚îú‚îÄ‚îÄ 02_inserciones_datos.sql     # Script de inserciones de datos
‚îú‚îÄ‚îÄ 03_django_settings.py        # Configuraci√≥n de Django
‚îú‚îÄ‚îÄ 04_django_views.py           # L√≥gica de vistas y conexi√≥n BD
‚îú‚îÄ‚îÄ 05_django_urls.py            # Rutas de la aplicaci√≥n
‚îú‚îÄ‚îÄ 06_html_template.html        # Interfaz web de registro
‚îú‚îÄ‚îÄ requirements.txt             # Dependencias del proyecto
‚îî‚îÄ‚îÄ manage.py                    # Script de administraci√≥n de Django

Estructura en la BD Oracle:
CREATE TABLE statements en: 01_crear_tablas.sql
INSERT statements en: 02_inserciones_datos.sql

================================================================================
4. INSTRUCCIONES DE INSTALACI√ìN
================================================================================

PASO 1: Crear Base de Datos en Oracle
--------------------------------------
Conectarse a Oracle SQL*Plus o SQL Developer:

$ sqlplus USUARIO/CONTRASE√ëA@BASEDATOS

Ejecutar script de creaci√≥n:
SQL> @01_crear_tablas.sql;
SQL> COMMIT;

Verificar tablas creadas:
SQL> SELECT table_name FROM user_tables 
     WHERE table_name IN ('CLIENTE', 'ABOGADO', 'CASO');

PASO 2: Insertar Datos de Prueba
---------------------------------
En SQL*Plus:
SQL> @02_inserciones_datos.sql;
SQL> COMMIT;

Verificar inserciones:
SQL> SELECT COUNT(*) FROM CLIENTE;      -- Debe retornar 5
SQL> SELECT COUNT(*) FROM ABOGADO;      -- Debe retornar 5
SQL> SELECT COUNT(*) FROM CASO;         -- Debe retornar 5

PASO 3: Crear Proyecto Django
------------------------------
En terminal:
$ mkdir ProyectoGabinete
$ cd ProyectoGabinete
$ python -m venv venv
$ source venv/bin/activate     # En Windows: venv\Scripts\activate
$ pip install -r requirements.txt

PASO 4: Crear Estructura Django
-------------------------------
$ django-admin startproject proyecto .
$ python manage.py startapp clientes

Copiar archivos:
- 03_django_settings.py ‚Üí proyecto/settings.py
- 04_django_views.py ‚Üí clientes/views.py
- 05_django_urls.py ‚Üí proyecto/urls.py
- 06_html_template.html ‚Üí templates/clientes/registro_cliente.html

PASO 5: Configurar Conexi√≥n a Oracle
------------------------------------
Editar settings.py - DATABASES:

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.oracle',
        'NAME': 'localhost:1521/orcl',     # Cambiar seg√∫n config
        'USER': 'SU_USUARIO',
        'PASSWORD': 'SU_CONTRASE√ëA',
    }
}

PASO 6: Iniciar Aplicaci√≥n
--------------------------
$ python manage.py runserver

Acceder a: http://127.0.0.1:8000/

================================================================================
5. EJECUCI√ìN DEL PROYECTO
================================================================================

Inicio del servidor Django:
$ cd ProyectoGabinete
$ source venv/bin/activate
$ python manage.py runserver

Salida esperada:
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.

Usar la aplicaci√≥n:
1. Abrir navegador en http://127.0.0.1:8000/
2. Para BUSCAR cliente: Ingresar c√≥digo (ej: C0001) y presionar üîé
3. Para GUARDAR cliente: Completar formulario y presionar üíæ Guardar
4. Todos los datos se guardan en Oracle

================================================================================
6. DESCRIPCI√ìN DE COMPONENTES
================================================================================

A) BASE DE DATOS (SQL)
----------------------
Tablas principales:
- CLIENTE: Datos de los clientes
- ABOGADO: Informaci√≥n de abogados y especializaci√≥n
- CASO: Casos asignados a clientes y abogados
- TIPODOCUMENTO: Cat√°logo de tipos de identificaci√≥n
- LUGAR: Juzgados y tribunales
- ETAPAPROCESAL: Estados del proceso legal
- ESPECIA_ETAPA: Relaci√≥n entre especializaci√≥n y etapas

Relaciones principales:
CLIENTE (1) ----> (N) CASO
ABOGADO (1) ----> (N) CASO
LUGAR (1) ------> (N) CASO
TIPODOCUMENTO (1) -> (N) CLIENTE

B) PYTHON / DJANGO (Backend)
-----------------------------
views.py contiene funciones:

1. conectar_bd()
   - Establece conexi√≥n con Oracle
   - Retorna conexi√≥n activa o None si falla

2. obtener_tipos_documento()
   - Una SOLA consulta SELECT a TIPODOCUMENTO
   - Retorna lista de tipos para combo

3. obtener_cliente(cod_cliente)
   - Una SOLA consulta JOIN para obtener cliente
   - Retorna diccionario con datos o None

4. buscar_cliente_ajax(request)
   - Endpoint para b√∫squeda mediante lupa
   - Valida c√≥digo y retorna JSON

5. guardar_cliente(request)
   - INSERT o UPDATE seg√∫n exista cliente
   - Valida todos los campos
   - Ejecuta transacci√≥n con COMMIT/ROLLBACK

C) FRONTEND (HTML/JavaScript)
-----------------------------
Caracter√≠sticas:
- Interfaz responsive con CSS Grid/Flexbox
- Validaci√≥n client-side de campos
- AJAX para b√∫squeda sin recargar p√°gina
- Indicadores de carga (spinner)
- Mensajes de √©xito/error en tiempo real
- Lista desplegable din√°mica de tipos de documento

Funciones JavaScript:
- buscarCliente(): Busca cliente por c√≥digo
- guardarCliente(): Guarda/actualiza cliente
- mostrarMensaje(): Muestra notificaciones

================================================================================
7. CONSULTAS IMPORTANTES
================================================================================

B√∫squeda de Cliente por C√≥digo:
SELECT c.codCliente, c.nomCliente, c.apellCliente, c.nDocumento, 
       c.idTipoDoc, t.descTipoDoc
FROM CLIENTE c
JOIN TIPODOCUMENTO t ON c.idTipoDoc = t.idTipoDoc
WHERE c.codCliente = 'C0001';

Obtener Tipos de Documento (Para combo):
SELECT idTipoDoc, descTipoDoc FROM TIPODOCUMENTO ORDER BY idTipoDoc;

Casos de un Abogado:
SELECT ca.noCaso, ca.fechaInicio, ca.fechaFin, ca.valor, 
       cl.nomCliente, ab.nombre
FROM CASO ca
JOIN CLIENTE cl ON ca.codCliente = cl.codCliente
JOIN ABOGADO ab ON ca.cedula = ab.cedula
WHERE ca.cedula = '1000000001'
ORDER BY ca.fechaInicio DESC;

Expediente de un Caso:
SELECT ex.consecExpe, ex.fechaEtapa, ep.nomEtapa, ca.noCaso
FROM EXPEDIENTE ex
JOIN ETAPAPROCESAL ep ON ex.codEtapa = ep.codEtapa
JOIN CASO ca ON ex.noCaso = ca.noCaso
WHERE ca.noCaso = 10001
ORDER BY ex.fechaEtapa;

================================================================================
8. NOTAS T√âCNICAS
================================================================================

Restricci√≥n de No FrameWork ORM:
‚úì Se usa SQL PURO con cx_Oracle
‚úì No se utiliza Django ORM (models.py)
‚úì Las consultas son expl√≠citas y optimizadas
‚úì Mayor control sobre las transacciones

Una Sola Consulta por Operaci√≥n:
‚úì obtener_tipos_documento() = 1 SELECT
‚úì obtener_cliente() = 1 SELECT con JOIN
‚úì buscar_cliente_ajax() = 1 SELECT
‚úì guardar_cliente() = 1 SELECT + 1 INSERT/UPDATE

Validaciones:
- Backend: Todas las validaciones se repiten en server
- Frontend: Validaciones r√°pidas para mejor UX
- Base de datos: Constraints NOT NULL y CHECK

Transacciones:
- AUTOCOMMIT deshabilitado
- INSERT/UPDATE con rollback en caso de error
- Confirmaci√≥n expl√≠cita con COMMIT

Seguridad:
- Par√°metros con bind variables (:param)
- Prevenci√≥n de SQL Injection
- CSRF token en formularios Django
- Validaci√≥n de entrada

================================================================================
TABLA DE PRUEBAS
================================================================================

Cliente de prueba en BD:
- C√≥digo: C0001
- Nombre: Juan
- Apellido: P√©rez Garc√≠a
- Documento: 1234567890
- Tipo: CC (C√©dula de Ciudadan√≠a)

Para probar b√∫squeda: Ingrese "C0001" en el campo de c√≥digo

================================================================================
TROUBLESHOOTING
================================================================================

Error: "Oracle Client Library could not be loaded"
Soluci√≥n: Instalar Oracle Client (conexi√≥n local) o usar cx_Oracle con
conexi√≥n remota configurada correctamente en tnsnames.ora

Error: "ORA-28001: the password has expired"
Soluci√≥n: Cambiar contrase√±a en SQL*Plus con:
ALTER USER USUARIO IDENTIFIED BY nueva_contrase√±a;

Error: "Connection refused"
Soluci√≥n: Verificar que Oracle est√° corriendo:
$ lsnrctl status

Error: "Template not found"
Soluci√≥n: Verificar estructura de directorios:
ProyectoGabinete/
‚îú‚îÄ‚îÄ proyecto/
‚îú‚îÄ‚îÄ clientes/
‚îî‚îÄ‚îÄ templates/
    ‚îî‚îÄ‚îÄ clientes/
        ‚îî‚îÄ‚îÄ registro_cliente.html

================================================================================
PARA LA SUSTENTACI√ìN
================================================================================

Elementos a entregar en ZIP:
‚úì 01_crear_tablas.sql
‚úì 02_inserciones_datos.sql
‚úì settings.py (Django)
‚úì views.py (con conexi√≥n Oracle)
‚úì urls.py
‚úì registro_cliente.html (template)
‚úì Archivo Power Designer (.pdm)
‚úì PDF del modelo ER

Estructura de carpetas para sustentaci√≥n:
Todos los archivos SQL, Python y HTML en COMPUTADOR LOCAL
(Sin bases de datos remotas)

Demostraci√≥n esperada:
1. Mostrar BD en Oracle SQL Developer
2. Ejecutar queries para validar datos
3. Iniciar servidor Django
4. Usar interfaz web para b√∫squeda y registro
5. Verificar inserciones en BD

================================================================================
Fin de la Gu√≠a | Versi√≥n 1.0
================================================================================
